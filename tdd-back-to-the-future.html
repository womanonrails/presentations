<!doctype html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'>

    <title>TDD - Back to the Future</title>
    <meta name='description' content='TDD helps with Quality Assurance from programmer perspective.'>

    <link rel='stylesheet' href='css/reset.css'>
    <link rel='stylesheet' href='css/reveal.css'>
    <link rel='stylesheet' href='css/theme/fractalsoft_white.css' id='theme'>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class='reveal'>
      <div class='slides'>

<section data-transition='slide-in slide-out'>
  <h1>
    TDD - Back to the Future
  </h1>

  <p>
    <a href='https://womanonrails.com' target='_blank' title='Web development from woman perspective'>Agnieszka Małaszkiewicz</a> at <a href='https://fractalsoft.org' target='_blank' title='Ruby on Rails developers'>Fractal Soft</a>
  </p>

  <a class='theme-box'
     id='theme-black'
     href="#"
     onclick="document.getElementById('theme').setAttribute('href','css/theme/fractalsoft_black.css'); return false;"></a>
  <a class='theme-box'
     id='theme-white'
     href="#"
     onclick="document.getElementById('theme').setAttribute('href','css/theme/fractalsoft_white.css'); return false;"></a>

  <aside class='notes' data-markdown>
- 1999 - _test-first programming_
- extreme programming
- 2002 - Kent Beck - _TDD by example_
- reminds me old movie
  </aside>
</section>

<section data-background='images/tdd-back-to-the-future/car.jpg'
         data-markdown>
Notes:
- 1985
- Do you remember it?
- look young
- my childhood
- TDD like this movie (old, out of date, boring)
</section>

<section data-background='images/quality-assurance/you.jpg'
         data-markdown>
Notes:
- me in numbers
- 5 years ago
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    <span class='fragment strike' data-fragment-index='1'>250</span><br>
    <span class='fragment' data-fragment-index='2'>20</span>
  </h2>

  <aside class='notes' data-markdown>
- 250 tests
- 20 tests pass
- rest failed
- legacy code - almost no tests
- integration tests out
- rest to be fixed
- new tests to write
- terrifying/terrific
- Who agrees with me?
- Anyone has been in this kind of situation?
- group therapy
  </aside>
</section>

<section data-transition='fade-in fade-out'>
  <h2 class='font-size-like-h1'>3500</h2>

  <aside class='notes' data-markdown>
- 3500 tests
- new functionality - TDD
- old code - ongoing process
- believe or not, but I enjoyed this process
- test, refactoring
  </aside>
</section>

<section data-transition='fade-in fade-out'>
  <h2 class='font-size-like-h1'>86%</h2>

  <aside class='notes' data-markdown>
- coverage
- I don't trust this metric
  </aside>
</section>

<section data-background='images/tdd-back-to-the-future/transmission.jpg'
         data-markdown>
Notes:
- based on my example and this presentation
- convince you that TDD can be done
- can be useful, beneficial
- can be fun
</section>

<section data-background='images/tdd-back-to-the-future/ok.jpg'
         data-markdown>
Notes:
- you look like that right now
- kind of...
- you don't look sure about that
</section>

<section data-background='images/tdd-back-to-the-future/start.jpg'
         data-markdown>
Notes:
- shall we start?
- I think so
- let's check what we have here
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    Quality Assurance<br>
    <span class='fragment' data-fragment-index='2'>?</span><br>
    <span class='fragment' data-fragment-index='1'>Tests</span>
  </h2>

  <aside class='notes' data-markdown>
- this next couple of slides are for me
- one clarification
- QA is a way of **preventing** mistakes
- Test - the way to check the correctness of something
  </aside>
</section>

<section data-transition='slide-in fade-out'>
  <blockquote cite="https://www.neotys.com/blog/test-engineer-or-qa-engineer/">
    “QA and Testing both have to <span class="fragment bold highlight-blue">make software better</span>,
     but QA enhances the quality via an <span class="fragment bold highlight-blue">improvement of development process</span>
     and testing enhances it via <span class="fragment bold highlight-blue"> finding bugs</span>.”
  </blockquote>
  <aside class='notes' data-markdown>
- both improve, make software better
- QA - improve the development process as a whole
- Testing - find bugs
  </aside>
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    Quality Assurance<br>
    <span class='fragment' data-fragment-index='1'>></span><br>
    Tests
  </h2>

  <aside class='notes' data-markdown>
- QA more than testing
- testing is a one way of having quality
  </aside>
</section>

<section data-background='#fff'
         data-transition='slide-in fade-out'>
  <h2 class='text-dark-blue font-size-like-h1'>
    Test-Driven Development
  </h2>
  <img alt='TDD' class='pure' data-src='images/shared/tdd.gif'>

  <aside class='notes' data-markdown>
- Who knows what TDD is?
- Who uses TDD on daily bases?
- software development driven by tests
- **1. TDD the way of Software Development**
- **2. The way to better understand the programming language**
- **3. Fearless refactoring**
- Red - Green - Refactoring
- write test -> check it
- write code -> check it
- simplify, refactor, improve
  </aside>
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    Two examples
  </h2>
</section>

<section>
  <section data-transition='slide-in fade-out'>
    <h2 class='big-font-size'>
      Example 1
    </h2>
    <p>Follow your test</p>

    <aside class='notes' data-markdown>
- write one method using TDD
- poker hand
- the same color/the same suit
- cards normalized (rank, color/suit)
- RSpec
    </aside>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Create test

```ruby
require 'spec_helper'
describe 'flush?' do
  it 'checks if array has one color' do
    flush_rule = flush?([1, 1, 1, 1])
    expect(flush_rule).to eq(true)
  end
end
```
<span class='fragment current-only' data-code-focus='2'></span>
<span class='fragment current-only' data-code-focus='3'></span>
<span class='fragment current-only' data-code-focus='5'></span>
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ rspec spec/lib/flush_spec.rb

Randomized with seed 35317
F

Failures:

  1) flush? checks if array has one color
     Failure/Error: flush_rule = flush?([1, 1, 1, 1])

     NoMethodError:
       undefined method `flush?' for #<RSpec::ExampleGroups::Flush:0x00000002a73d50>
     # ./spec/lib/flush_spec.rb:5:in `block (2 levels) in <top (required)>'

Finished in 0.01294 seconds (files took 0.75094 seconds to load)
1 example, 1 failure
```
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='12'></span>

Notes:
- test failed
- `undefined method 'flush?'`
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
#### Create method

```ruby
def flush?
end
```
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ rspec spec/lib/flush_spec.rb

Randomized with seed 28476
F

Failures:

  1) flush? checks if array has one color
     Failure/Error:
       def flush?
       end

     ArgumentError:
       wrong number of arguments (given 1, expected 0)
     # ./spec/lib/flush_spec.rb:3:in `flush?'
     # ./spec/lib/flush_spec.rb:9:in `block (2 levels) in <top (required)>'

Finished in 0.01024 seconds (files took 0.66129 seconds to load)
1 example, 1 failure
```
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='14'></span>

Notes:
- autopilot
- don't need to think
- just flow
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
#### Add argument

```ruby
def flush?(array)
end
```
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ rspec spec/lib/flush_spec.rb

Randomized with seed 34173
F

Failures:

  1) flush? checks if array has one color
     Failure/Error: expect(flush_rule).to eq(true)

       expected: true
            got: nil

       (compared using ==)
     # ./spec/lib/flush_spec.rb:10:in `block (2 levels) in <top (required)>'

Finished in 0.05983 seconds (files took 0.83267 seconds to load)
1 example, 1 failure
```
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='11-12'></span>

Notes:
- `nil` instead of `true`
    </script>
  </section>

  <section data-transition='slide-in fade-out'>
    <h4>
      Add first logic
    </h4>
    <div data-markdown>
```ruby
def flush?(array)
  true
end
```
    </div>
    <div class='fragment'
         data-fragment-index='1'>
      <h4>
        Run test
      </h4>
      <div data-markdown>
```bash
$ rspec spec/lib/flush_spec.rb

Randomized with seed 40116
.

Finished in 0.01189 seconds (files took 0.65796 seconds to load)
1 example, 0 failures
```
      </div>
    </div>

    <aside class='notes'
           data-markdown>
- the simplest code: `true`
- refactoring: code and test have both `true`
- **triangulation**
- two object you can find position of third
- or distance between two elements
- crossing lines
    </aside>
  </section>

  <section>
    <h4>
      CSI: NY
    </h4>
    <img alt='Triangulation based on CSI: NY series'
         class='pure'
         data-src='images/shared/triangulation.webp'>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Add new test

```ruby
describe 'flush?' do
  it 'checks if array has one color'

  it 'checks if array has more then one color' do
    flush_rule = flush?([1, 1, 2, 1])
    expect(flush_rule).to eq(false)
  end
end
```
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='6'></span>
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### And run this tests</h4>

```bash
$ rspec spec/lib/flush_spec.rb

Randomized with seed 6606
.F

Failures:

  1) flush? checks if array has more then one color
     Failure/Error: expect(flush_rule).to eq(false)

       expected: false
            got: true

       (compared using ==)
     # ./spec/lib/flush_spec.rb:15:in `block (2 levels) in <top (required)>'

Finished in 0.04907 seconds (files took 0.63654 seconds to load)
2 examples, 1 failure
```
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='11-12'></span>
    </script>
  </section>

  <section data-transition='slide-in fade-out'>
    <h4>
      Add more logic
    </h4>
    <div data-markdown>
```ruby
def flush?(array)
  array.uniq.size == 1
end
```
    </div>
    <div class='fragment'
         data-fragment-index='1'>
      <h4>
        Run tests
      </h4>
      <div data-markdown>
```bash
$ rspec spec/lib/flush_spec.rb

Randomized with seed 33907
..

Finished in 0.01092 seconds (files took 0.57891 seconds to load)
2 examples, 0 failures
```
      </div>
    </div>

    <aside class='notes' data-markdown>
- take only unique elements
- `size == 1` one color
    </aside>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Unexpected usage

```ruby
def flush?(array)
  array.uniq.size == 1
end

flush?([1, 2, 1])
# => false
flush?(['#fff', '#fff', '#fff'])
# => true
```
<span class='fragment current-only' data-code-focus='5'></span>
<span class='fragment current-only' data-code-focus='7'></span>

Notes:
- power of Ruby
- power of simplicity
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
### Summary #1
- flow <!-- .element: class="fragment" -->
- step size <!-- .element: class="fragment" -->
- assurance <!-- .element: class="fragment" -->

Notes:
- tests give us the ways(road)
- step size (smaller, bigger steps)
- sure, that code is working
    </script>
  </section>
</section><!-- Example 1 -->

<section>
  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
## Example 2

Trust your tests & do refactoring

Notes:
- Mini Test
- have tests -> write code
- like removing code to do refactoring
    </script>
  </section>

  <section data-markdown
           data-transition='fade-in fade-out'>
    <script type='text/template'>
#### Existing code

```ruby
class BaseClass
end
```

<div class='fragment' data-fragment-index='1'>

```ruby
class Item < BaseClass
  attr_accessor :price, :name

  def initialize(attributes = {})
    @price = attributes[:price]
    @name  = attributes[:name]
  end

  validates_presence_of :name
  validates_numericality_of :price
end
```
<span class='fragment current-only' data-code-focus='5-6' data-code-block='2'></span>
<span class='fragment current-only' data-code-focus='2' data-code-block='2'></span>
<span class='fragment current-only' data-code-focus='9-10' data-code-block='2'></span>

</div>

Notes:
- empty `BaseClass`
- `Item` class inherits `BaseClass`
- stay with the same interface
- instance variables `price` and `name`
- getters & setters, reader & writer
- 2 validation methods
- it tastes like rails
    </script>
  </section>

  <section class='middle-size'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Existing test

```ruby
class TestItem < Minitest::Test
  def test_validation
    item1 = Item.new(:name => "Guitar")
    item2 = Item.new(:price => 55)
    item3 = Item.new()
    item4 = Item.new(:name => "Guitar", :price => "ABC")
    item5 = Item.new(:name => "Guitar", :price => 55)

    assert !item1.valid?
    assert item1.errors == ["price must be number"]

    assert !item2.valid?
    assert item2.errors == ["name can't be blank"]

    assert !item3.valid?
    assert item3.errors == ["name can't be blank", "price must be number"]

    assert !item4.valid?
    assert item4.errors == ["price must be number"]

    assert item5.valid?
  end
end
```
<span class='fragment current-only' data-code-focus='3-7'></span>
<span class='fragment current-only' data-code-focus='10'></span>
<span class='fragment current-only' data-code-focus='13'></span>
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Traceback (most recent call last):
  3: from item_test.rb:1:in `<main>'
  2: from item_test.rb:1:in `require_relative'
  1: from /home/agnieszka/workspace/pair_programming/item.rb:6:in `<top (required)>'
/home/agnieszka/workspace/pair_programming/item.rb:14:in `<class:Item>':
undefined method `validates_presence_of' for Item:Class (NoMethodError)
```
<span class='fragment current-only' data-code-focus='7' data-fragment-index='1'></span>

<div class='fragment' data-fragment-index='2'>
<h4>Write code</h4>

```ruby
class BaseClass
  def self.validates_presence_of
  end
end
```
</div>

Notes:
- tests are not working
- missing method for Item class: `validates_presence_of`
- class method
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Traceback (most recent call last):
  4: from item_test.rb:1:in `<main>'
  3: from item_test.rb:1:in `require_relative'
  2: from /home/agnieszka/workspace/pair_programming/item.rb:6:in `<top (required)>'
  1: from /home/agnieszka/workspace/pair_programming/item.rb:14:in `<class:Item>'
/home/agnieszka/workspace/pair_programming/base_class.rb:7:in `validates_presence_of':
wrong number of arguments (given 1, expected 0) (ArgumentError)
```
<span class='fragment current-only' data-code-focus='8' data-fragment-index='1'></span>

<div class='fragment' data-fragment-index='2'>
  <h4>
    Write code
  </h4>

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end
end
```
</div>
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Traceback (most recent call last):
  3: from item_test.rb:1:in `<main>'
  2: from item_test.rb:1:in `require_relative'
  1: from /home/agnieszka/workspace/pair_programming/item.rb:6:in `<top (required)>'
/home/agnieszka/workspace/pair_programming/item.rb:15:in `<class:Item>':
undefined method `validates_numericality_of' for Item:Class (NoMethodError)
Did you mean?  validates_presence_of
```
<span class='fragment current-only' data-code-focus='7' data-fragment-index='1'></span>

<div class='fragment' data-fragment-index='2'>
  <h4>
    Write code
  </h4>

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of
  end
end
```
</div>

Notes:
- similar steps
- we know what happened
- we could change the size of the step
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Traceback (most recent call last):
  4: from item_test.rb:1:in `<main>'
  3: from item_test.rb:1:in `require_relative'
  2: from /home/agnieszka/workspace/pair_programming/item.rb:6:in `<top (required)>'
  1: from /home/agnieszka/workspace/pair_programming/item.rb:15:in `<class:Item>'
/home/agnieszka/workspace/pair_programming/base_class.rb:10:in `validates_numericality_of':
wrong number of arguments (given 1, expected 0) (ArgumentError)
```
<span class='fragment current-only' data-code-focus='8' data-fragment-index='1'></span>

<div class='fragment' data-fragment-index='2'>
  <h4>
    Write code
  </h4>

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end
end
```
</div>
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Run options: --seed 43301

# Running:

E

Finished in 0.000790s, 1265.3183 runs/s, 0.0000 assertions/s.

  1) Error:
TestItem#test_validation:
NoMethodError: undefined method `valid?' for #<Item:0x0000000001a731d0 @price=nil, @name="Guitar">
    item_test.rb:14:in `test_validation'

1 runs, 0 assertions, 0 failures, 1 errors, 0 skips
```
<span class='fragment current-only' data-code-focus='6'></span>
<span class='fragment current-only' data-code-focus='12'></span>

Notes:
- test is running
- failing
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
#### Write code

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
  end
end
```
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Run options: --seed 14791

# Running:

E

Finished in 0.000862s, 1159.7712 runs/s, 1159.7712 assertions/s.

  1) Error:
TestItem#test_validation:
NoMethodError: undefined method `errors' for #<Item:0x000000000286b5f8 @price=nil, @name="Guitar">
    item_test.rb:15:in `test_validation'

1 runs, 1 assertions, 0 failures, 1 errors, 0 skips
```
<span class='fragment current-only' data-code-focus='6'></span>
<span class='fragment current-only' data-code-focus='12'></span>
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
#### Write code

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
  end

  def errors
  end
end
```
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Run options: --seed 29139

# Running:

F

Finished in 0.000691s, 1447.7416 runs/s, 2895.4832 assertions/s.

  1) Failure:
TestItem#test_validation [item_test.rb:15]:
Expected false to be truthy.

1 runs, 2 assertions, 1 failures, 0 errors, 0 skips
```
<span class='fragment current-only' data-code-focus='6'></span>
<span class='fragment current-only' data-code-focus='12'></span>
<span class='fragment current-only' data-code-focus='11'></span>

Notes:
- time for logic
- line 15 expect `false` to be truthy
    </script>
  </section>

  <section class='middle-size'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Check assertions

```ruby
class TestItem < Minitest::Test
  def test_validation
    item1 = Item.new(:name => "Guitar")
    item2 = Item.new(:price => 55)
    item3 = Item.new()
    item4 = Item.new(:name => "Guitar", :price => "ABC")
    item5 = Item.new(:name => "Guitar", :price => 55)

    assert !item1.valid?
    assert item1.errors == ["price must be number"]

    assert !item2.valid?
    assert item2.errors == ["name can't be blank"]

    assert !item3.valid?
    assert item3.errors == ["name can't be blank", "price must be number"]

    assert !item4.valid?
    assert item4.errors == ["price must be number"]

    assert item5.valid?
  end
end
```
<span class='fragment current-only' data-code-focus='10'></span>
<span class='fragment current-only' data-code-focus='9'></span>
<span class='fragment current-only' data-code-focus='10'></span>

Notes:
- validation returns `false`
- missing `["price must be number"]`
- trivial implementation
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Write code

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
  end

  def errors
    ["price must be number"]
  end
end
```
<span class='fragment current-only' data-code-focus='12'></span>
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Run test

```bash
$ ruby item_test.rb
Run options: --seed 15517

# Running:

F

Finished in 0.000805s, 1242.0108 runs/s, 4968.0430 assertions/s.

  1) Failure:
TestItem#test_validation [item_test.rb:18]:
Expected false to be truthy.

1 runs, 4 assertions, 1 failures, 0 errors, 0 skips
```
<span class='fragment current-only' data-code-focus='6'></span>
<span class='fragment current-only' data-code-focus='12'></span>
<span class='fragment current-only' data-code-focus='11'></span>

Notes:
- line 18
    </script>
  </section>

  <section class='middle-size'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Check assertions

```ruby
class TestItem < Minitest::Test
  def test_validation
    item1 = Item.new(:name => "Guitar")
    item2 = Item.new(:price => 55)
    item3 = Item.new()
    item4 = Item.new(:name => "Guitar", :price => "ABC")
    item5 = Item.new(:name => "Guitar", :price => 55)

    assert !item1.valid?
    assert item1.errors == ["price must be number"]

    assert !item2.valid?
    assert item2.errors == ["name can't be blank"]

    assert !item3.valid?
    assert item3.errors == ["name can't be blank", "price must be number"]

    assert !item4.valid?
    assert item4.errors == ["price must be number"]

    assert item5.valid?
  end
end
```
<span class='fragment current-only' data-code-focus='13'></span>

Notes:
- check if `price` is a number
- check if `name` is not empty string
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Write code

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
    @errors_list = []
    @errors_list << "name can't be blank" if @name.nil?
    @errors_list << "price must be number" unless @price.is_a?(Integer)
    @errors_list.size == 0
  end

  def errors
    @errors_list
  end
end
```
<span class='fragment current-only' data-code-focus='16'></span>
<span class='fragment current-only' data-code-focus='10-11'></span>
<span class='fragment current-only' data-code-focus='12'></span>
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
#### Run test

```bash
$ ruby item_test.rb
Run options: --seed 35483

# Running:

.

Finished in 0.000730s, 1369.7898 runs/s, 12328.1085 assertions/s.

1 runs, 9 assertions, 0 failures, 0 errors, 0 skips
```

Notes:
- finally, test pass
- 5-10 min - working code
- time for refactoring
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Look closer

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
    @errors_list = []
    @errors_list << "name can't be blank" if @name.nil?
    @errors_list << "price must be number" unless @price.is_a?(Integer)
    @errors_list.size == 0
  end

  def errors
    @errors_list
  end
end
```
<span class='fragment current-only' data-code-focus='9'></span>
<span class='fragment current-only' data-code-focus='9-12'></span>
<span class='fragment current-only' data-code-focus='2-6'></span>

Notes:
- TODO list
- **instance variable instead of getters/readers**
- **logic for errors inside `valid?` method**
- **don't use class method**
- **elasticity** - how check `price` is `blank`
- "Open Close" rule
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
## TODO list

- use getters <!-- .element: class="fragment bold highlight-blue" -->
- Single Responsibility Principle - `valid?` method
- use Class Methods
- more abstraction
- Open - Close rule
    </script>
  </section>

  <section class='middle-size'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Use getters

```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
    @errors_list = []
    errors_list << "name can't be blank" if name.nil?
    errors_list << "price must be number" unless price.is_a?(Integer)
    errors_list.size == 0
  end

  def errors
    errors_list
  end

  private

  attr_accessor :errors_list
end
```
<span class='fragment current-only' data-code-focus='21'></span>
<span class='fragment current-only' data-code-focus='9-12'></span>
<span class='fragment current-only' data-code-focus='16'></span>

Notes:
- check tests after each change
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
## TODO list

- **use getters** <!-- .element: class="fragment strike unbold" -->
- Single Responsibility Principle - `valid?` method
- use Class Methods <!-- .element: class="fragment bold highlight-blue" -->
- more abstraction
- Open - Close rule
    </script>
  </section>

  <section class='middle-size no-margin'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
```ruby
class BaseClass
  def self.validates_presence_of(name)
    @@presence_array ||= []
    @@presence_array << name
  end

  def self.validates_numericality_of(name)
  end

  def valid?
    @errors_list = []
    @@presence_array.each do |item|
      errors_list << "#{item} can't be blank" if send(item).nil?
    end
    errors_list << "price must be number" unless price.is_a?(Integer)
    errors_list.size == 0
  end

  def errors
    errors_list
  end

  private

  attr_accessor :errors_list
end
```
<span class='fragment current-only' data-code-focus='2-5'></span>
<span class='fragment current-only' data-code-focus='2'></span>
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='12-14'></span>
<span class='fragment current-only' data-code-focus='12'></span>
<span class='fragment current-only' data-code-focus='13'></span>

Notes:
- allow table of attributes
- it is possible to do **presence** on `price`
    </script>
  </section>

  <section class='midi-size no-margin'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
```ruby
class BaseClass
  def self.validates_presence_of(name)
    @@presence_array ||= []
    @@presence_array << name
  end

  def self.validates_numericality_of(name)
    @@numericality_array ||=[]
    @@numericality_array << name
  end

  def valid?
    @errors_list = []
    @@presence_array.each do |item|
      errors_list << "#{item} can't be blank" if send(item).nil?
    end
    @@numericality_array.each do |item|
      errors_list << "#{item} must be number" unless send(item).is_a?(Integer)
    end
    errors_list.size == 0
  end

  def errors
    errors_list
  end

  private

  attr_accessor :errors_list
end
```
<span class='fragment current-only' data-code-focus='7-10'></span>
<span class='fragment current-only' data-code-focus='17-19'></span>
<span class='fragment current-only' data-code-focus='2-10'></span>
<span class='fragment current-only' data-code-focus='14-19'></span>

Notes:
- DRY - **duplication**
- `valid?` knows too much
- new validation rule - change in `valid?`
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
## TODO list

- ~~use getters~~
- Single Responsibility Principle - valid? method <!-- .element: class="fragment bold highlight-blue" data-fragment-index="3" -->
- use Class Methods <!-- .element: class="fragment strike unbold" data-fragment-index="1" -->
- more abstraction
- Open - Close rule
- code duplication <!-- .element: class="fragment" data-fragment-index="2" -->

Notes:
- extract logic from `valid?`
- validation logic in new class
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Single Responsibility Principle

```ruby
class PresenceValidator
  attr_reader :name

  def initialize(name)
    @name = name
  end

  def error_message
    "#{name} can't be blank"
  end

  def valid?(item)
    !item.nil?
  end
end
```
<span class='fragment current-only' data-code-focus='1'></span>
<span class='fragment current-only' data-code-focus='9'></span>
<span class='fragment current-only' data-code-focus='12-14'></span>

Notes:
- responsible only for validation
- **don't have tests**
- if works in base class, then should work here
- tests _post mortem_, after code
- no new logic, logic extraction
    </script>
  </section>

  <section class='midi-size no-margin'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
```ruby
class BaseClass
  def self.validates_presence_of(name)
    @@validators ||= []
    @@validators << PresenceValidator.new(name)
  end

  def self.validates_numericality_of(name)
    @@numericality_array ||=[]
    @@numericality_array << name
  end

  def valid?
    @errors_list = []
    @@validators.each do |item|
      errors_list << item.error_message unless item.valid?(send(item.name))
    end
    @@numericality_array.each do |item|
      errors_list << "#{item} must be number" unless send(item).is_a?(Integer)
    end
    errors_list.size == 0
  end

  def errors
    errors_list
  end

  private

  attr_accessor :errors_list
end
```
<span class='fragment current-only' data-code-focus='2'></span>
<span class='fragment current-only' data-code-focus='4'></span>
<span class='fragment current-only' data-code-focus='14-16'></span>

Notes:
- metaprogramming
- `item.valid?(send(item.name))`
- tricky, need reader in base class
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
#### Single Responsibility Principle

```ruby
class NumericallityValidator
  attr_reader :name

  def initialize(name)
    @name = name
  end

  def error_message
    "#{name} must be number"
  end

  def valid?(item)
    item.is_a?(Integer)
  end
end
```
<span class='fragment current-only' data-code-focus='1'></span>
<span class='fragment current-only' data-code-focus='9'></span>
<span class='fragment current-only' data-code-focus='12-14'></span>

Notes:
- similar code for next validator
- more extraction - base validation class
    </script>
  </section>

  <section class='middle-size no-margin'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
```ruby
class BaseClass
  def self.validates_presence_of(name)
    @@validators ||= []
    @@validators << PresenceValidator.new(name)
  end

  def self.validates_numericality_of(name)
    @@validators ||= []
    @@validators << NumericallityValidator.new(name)
  end

  def valid?
    @errors_list = []
    @@validators.each do |item|
      errors_list << item.error_message unless item.valid?(send(item.name))
    end
    errors_list.size == 0
  end

  def errors
    errors_list
  end

  private

  attr_accessor :errors_list
end
```
<span class='fragment current-only' data-code-focus='7'></span>
<span class='fragment current-only' data-code-focus='9'></span>
<span class='fragment current-only' data-code-focus='14-16'></span>

Notes:
- one variable `@@validators`
- less duplication
- logic in separate classes
    </script>
  </section>

  <section data-markdown
           data-transition='fade-in fade-out'>
    ## Small fixes
  </section>

  <section class='middle-size'
           data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
```ruby
class BaseClass
  attr_reader :errors

  def self.validates_presence_of(name)
    @validators ||= []
    @validators << PresenceValidator.new(name)
  end

  def self.validates_numericality_of(name)
    @validators ||= []
    @validators << NumericallityValidator.new(name)
  end

  def valid?
    @errors = []
    self.class.instance_variable_get(:@validators).each do |item|
      errors << item.error_message unless item.valid?(send(item.name))
    end
    errors.empty?
  end

  private

  attr_writer :errors
end
```
<span class='fragment current-only' data-code-focus='2'></span>
<span class='fragment current-only' data-code-focus='24'></span>
<span class='fragment current-only' data-code-focus='15'></span>
<span class='fragment current-only' data-code-focus='16'></span>
<span class='fragment current-only' data-code-focus='19'></span>

Notes:
- instance variable, instead of class variable
- `self.class.instance_variable_get(:@validators)`
    </script>
  </section>

  <section data-markdown
           data-transition='slide-in fade-out'>
    <script type='text/template'>
## TODO list

- ~~use getters~~
- Single Resposibility Principle - valid? method <!-- .element: class="fragment strike unbold" -->
- ~~use Class Methods~~
- more abstraction <!-- .element: class="fragment strike" -->
- Open - Close rule <!-- .element: class="fragment strike" -->
- code duplication <span class='fragment'>???</span>
- more ??? <!-- .element: class="fragment fade-in" -->

Notes:
- `valid?` more stable O-C
- inheritance, convention, metaprogramming
    </script>
  </section>

  <section class='no-max-height'
           data-markdown
           data-transition='slide-in fade-out'>
```ruby
class BaseClass
  def self.validates_presence_of(name)
  end

  def self.validates_numericality_of(name)
  end

  def valid?
    @errors_list = []
    @errors_list << "name can't be blank" if @name.nil?
    @errors_list << "price must be number" unless @price.is_a?(Integer)
    @errors_list.size == 0
  end

  def errors
    @errors_list
  end
end
```

Notes:
- trivial implementation
- **good** - is working
- **good** - readable
- **bad** - hard to maintenance
- **bad** - not agile (no adapting to changes)
  </section>

  <section class='middle-size'
           data-markdown
           data-transition='fade-in fade-out'>
```ruby
class BaseClass
  attr_reader :errors

  def self.validates_presence_of(name)
    @validators ||= []
    @validators << PresenceValidator.new(name)
  end

  def self.validates_numericality_of(name)
    @validators ||= []
    @validators << NumericallityValidator.new(name)
  end

  def valid?
    @errors = []
    self.class.instance_variable_get(:@validators).each do |item|
      errors << item.error_message unless item.valid?(send(item.name))
    end
    errors.empty?
  end

  private

  attr_writer :errors
end
```

Notes:
- more agile, elastic
- easy to expand
- still readable, maybe less
  </section>
</section><!-- Example 2 -->

<section data-markdown
         data-transition='slide-in fade-out'>
  <script type='text/template'>
## Summary
- follow the flow <!-- .element: class="fragment" -->
- assurance <!-- .element: class="fragment" -->
- safe refactoring <!-- .element: class="fragment" -->
- less stress <!-- .element: class="fragment" -->
- experiment friendly <!-- .element: class="fragment" -->
- fail fast <!-- .element: class="fragment" -->
- progress in iterations <!-- .element: class="fragment" -->
- can be fun <!-- .element: class="fragment" -->

Notes:
- TDD (tests before code) - better coverage
- TDD helps
- turtle and hare
- turtle slow but step by step to goal
- hare fast on beginning
- test coverage
- fail fast - not working you can revert it fast
  </script>
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    Running tests
  </h2>
  <img alt='How looks console when all tests passed - rainbow style'
       class='pure'
       data-src='images/shared/testing/nopaperwork-minitest-rainbow.png'>
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    Nyan Cat
  </h2>
  <img alt='Running test with Nyan Cat style'
       class='pure'
       data-src='images/shared/testing/rspec-nyan-cat.gif'>
</section>

<section data-transition='slide-in fade-out'>
  <h2 class='font-size-like-h1'>
    My project is different...
  </h2>
  <aside class='notes' data-markdown>
- excuse
- can't imagine TDD in your project
- start small - from kata
  </aside>
</section>

<section data-background='#fff'
         data-transition='slide-in fade-out'>
  <h2>
    Gilded Rose Kata
  </h2>
  <img alt='Kata'
       class='pure'
       data-src='images/quality-assurance/gilded-rose-kata.png'>
  <p>
    <a href='https://github.com/emilybache/GildedRose-Refactoring-Kata'
       rel='nofollow'
       target='_blank'>
      github.com/emilybache/GildedRose-Refactoring-Kata
    </a>
  </p>
  <aside class='notes' data-markdown>
- exercise
- different languages (Java, Scala, Go, Rust)
  </aside>
</section>

<section data-transition='slide-in fade-out'>
  <img alt='Saving trap'
       class='pure'
       data-src='images/tdd-back-to-the-future/saving.png'>
  <aside class='notes' data-markdown>
- don't save on tests
- stiupid saving
- short term saving
- more troubles in future
  </aside>
</section>

<section data-transition='slide-in fade-out'>
  <img alt='Angry hare'
       class='pure'
       data-src='images/tdd-back-to-the-future/hare.png'>
  <aside class='notes' data-markdown>
- don't be like hare
- fast at the beginning
- but slow later, leazy
  </aside>
</section>

<section data-transition='slide-in fade-out'>
  <img alt='Happy turtle'
       class='pure'
       data-src='images/tdd-back-to-the-future/turtle.svg'>
  <aside class='notes' data-markdown>
- be like a turtle
- step by step to achieve your goal
- good code quality
  </aside>
</section>

<section data-background='images/tdd-back-to-the-future/ninja-turtles.jpg'
         data-transition='slide-in fade-out'>

  <aside class='notes' data-markdown>
- Teenage Mutant Ninja Turtles
  </aside>
</section>

<section class='fractalsoft-slide'
         data-background='#fff'
         data-transition='slide-in fade-out'>
  <div class='row'>
    <div class='column'>
      <img alt='Fractal Soft logo'
           class='pure'
           data-src='images/icons/svg/fractalsoft.svg'
           height='100%'>
    </div>
    <div class='column'>
      <h2 class='fractalsoft-name vertical-middle uppercase'>Fractal&nbsp;Soft</h2>
    </div>
  </div>
  <div class='row'>
    <div class='column'>
      <span class='fragment stamp is-approved'>
        We're hiring!
      </span>
    </div>
  </div>
  <div class='row'>
    <div class='column'>
      <p class='fragment'>
        <br>
        <a href='mailto:hr@fractalsoft.org'>
          mail to hr@fractalsoft.org
        </a>
      </p>
    </div>
  </div>
</section>

<section data-transition='slide-in fade-out'>
  <img alt='Rails Girls heart'
       class='pure'
       data-src='images/icons/svg/railsgirls-heart.svg'
       width='50%'>
  <h2 class='railsgirls-name'>
    <a href='https://fractalsoft.org/community/rails-girls'>
      Rails Girls
    </a>
  </h2>
  <aside class='notes' data-markdown>
- I support RG
- What is RG?
- bring women in IT
  </aside>
</section>

<section data-markdown
         data-transition='slide-in fade-out'>
  <script type='text/template'>
    ## Feedback <!-- .element: class="huge-font" -->
  </script>
</section>

<section data-transition='slide-in fade-out'>
  <img alt='Woman on Rails logo'
       class='pure'
       data-src='images/shared/womanonrails.svg'
       width='100%'>
  <h3 class='fragment'>
    <a href='https://womanonrails.com/presentations/'>womanonrails.com/presentations</a>
  </h3>
</section>

<section data-markdown
         data-transition='slide-in fade-out'
         style='font-size: 20pt; text-align: left;'>
### Bibliography

#### Books
- [Test Driven Development: By Example - Ken Beck](https://amzn.to/2HXdSHy)
- [Working Effectively with Legacy Code - Michael Feathers](https://amzn.to/2v36esF)
- [Clean Code: A Handbook of Agile Software Craftsmanship - Robert C. Martin](https://amzn.to/395gxuM)
- [Design Patterns in Ruby - Russ Olsen](https://amzn.to/32qK8fQ)
- [Practical Object-Oriented Design in Ruby: An Agile Primer - Sandi Metz](https://amzn.to/2Vk9Vox)
- [The Pragmatic Programmer: From Journeyman to Master - Andrew Hund, David Thomas](https://amzn.to/2TgmfTR)

#### Presentations
- [All the Little Things by Sandi Metz](https://www.youtube.com/watch?v=8bZh5LMaSmE)
- [Nothing is Something by Sandi Metz](https://www.youtube.com/watch?v=OMPfEXIlTVE)
- [Best Ruby on Rails refactoring talks](https://infinum.co/the-capsized-eight/best-ruby-on-rails-refactoring-talks)
- [Are you an Egoistic Programmer? - presentation about refactoring](https://womanonrails.com/presentation-refactoring-egoistic-programmer/#1)
</section>

<section class='pull-right last-section' data-background='images/shared/unicorn-agnieszka.jpg'>
  <img alt='Woman on Rails logotype' class='pure' data-src='images/womanonrails.png' height='94' width='300'>
  <h2 class='author-name'>Agnieszka Małaszkiewicz</h2>
  <p class='author-mail'>agnieszka (at) fractalsoft (dot) org</p>

  <div class='links'>
    <p>
      <a href='https://womanonrails.com/' target='_blank' title='Web development from woman perspective'>
        WomanOnRails.com
      </a>
    </p>
    <p>
      <a href='https://twitter.com/womanonrails' rel='nofollow noopener' target='_blank' title='Twitter @womanonrails'>
      <span class='zocial-twitter'></span> @womanonrails
    </a>
    </p>
    <p>
      <a href='https://fractalsoft.org/pl' target='_blank' title='Ruby on Rails and JavaScript programmers'>
        <span>
          <img alt='Fractal Soft logo' class='pure' data-src='images/icons/svg/fractalsoft.svg' style='width: 30px;'>
          Fractal Soft
        </span>
      </a>
    </p>
  </div>

  <p class='social'>
    <a href='https://github.com/womanonrails' rel='nofollow noopener' target='_blank' title='GitHub'>
      <span class='zocial-github'></span>
    </a>
    <a href='https://www.instagram.com/womanonrails' rel='nofollow noopener' target='_blank' title='Instagram'>
      <span class='zocial-instagram'></span>
    </a>
    <a href='https://www.facebook.com/107403177317825/' rel='nofollow noopener' target='_blank' title='Facebook'>
      <span class='zocial-facebook'></span>
    </a>
    <a href='https://www.youtube.com/@womanonrails' rel='nofollow noopener' target='_blank' title='YouTube'>
      <span class='zocial-youtube'></span>
    </a>
    <a href='https://vimeo.com/womanonrails' rel='nofollow noopener' target='_blank' title='Vimeo'>
      <span class='zocial-vimeo'></span>
    </a>
  </p>
</section>

      </div>
    </div>

    <script src='js/reveal.js'></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        // Transition style for full page slide backgrounds
        backgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom

        // Vertical centering of slides
        center: true,

        // Display presentation control arrows
        controls: false,

        // Visibility rule for backwards navigation arrows; "faded", "hidden" or "visible"
        controlsBackArrows: 'faded',

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: 39,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL, so that reloading brings you to the same fragment position
        fragmentInURL: true,

        hash: true,

        // Flags if we should show a help overlay when the questionmark key is pressed
        help: true,

        // Hides the address bar on mobile devices
        hideAddressBar: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Loop the presentation
        loop: false,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // Enable the slide overview mode
        overview: true,

        // Display a presentation progress bar
        progress: false,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Display the page number of the current slide
        slideNumber: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Transition style
        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Transition speed
        transitionSpeed: 'default', // default/fast/slow

        // Number of slides away from the current that are visible
        viewDistance: 3,

        dependencies: [
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true },
          { src: 'plugin/search/search.js', async: true },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true },
          {
            src: 'plugin/reveal-code-focus/reveal-code-focus.js',
            async: true,
            callback: function() { RevealCodeFocus(); }
          }
        ]
      });
    </script>
  </body>
</html>
